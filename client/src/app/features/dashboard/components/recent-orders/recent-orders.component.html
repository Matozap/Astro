<mat-card class="widget-card">
  <mat-card-header>
    <mat-card-title class="widget-title">
      <mat-icon>receipt_long</mat-icon>
      Recent Orders
    </mat-card-title>
    <a mat-button color="primary" routerLink="/orders" class="view-all">
      View All
      <mat-icon>arrow_forward</mat-icon>
    </a>
  </mat-card-header>
  <mat-card-content>
    @if (loading()) {
      <div class="skeleton-table">
        @for (i of [1, 2, 3, 4, 5]; track i) {
          <div class="skeleton-row"></div>
        }
      </div>
    } @else {
      <table mat-table [dataSource]="orders()" class="orders-table">
        <!-- Order ID Column -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>Order</th>
          <td mat-cell *matCellDef="let order">
            <a [routerLink]="['/orders', order.id]" class="order-link">
              {{ order.id }}
            </a>
          </td>
        </ng-container>

        <!-- Customer Column -->
        <ng-container matColumnDef="customer">
          <th mat-header-cell *matHeaderCellDef>Customer</th>
          <td mat-cell *matCellDef="let order">{{ order.customerName }}</td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let order">
            <span
              class="status-badge"
              [style.background-color]="getStatusColor(order.status) + '20'"
              [style.color]="getStatusColor(order.status)"
            >
              <mat-icon class="status-icon">{{ getStatusIcon(order.status) }}</mat-icon>
              {{ formatStatus(order.status) }}
            </span>
          </td>
        </ng-container>

        <!-- Total Column -->
        <ng-container matColumnDef="total">
          <th mat-header-cell *matHeaderCellDef>Total</th>
          <td mat-cell *matCellDef="let order" class="amount-cell">
            {{ order.total?.amount | currency:'USD':'symbol':'1.2-2' }}
          </td>
        </ng-container>

        <!-- Date Column -->
        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>Time</th>
          <td mat-cell *matCellDef="let order" class="time-cell">
            {{ getTimeAgo(order.createdAt) }}
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    }
  </mat-card-content>
</mat-card>
